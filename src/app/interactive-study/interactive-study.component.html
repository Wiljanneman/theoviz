
<!-- Main Content -->
<div class="flex flex-col lg:flex-row w-full h-screen">
  <!-- Mobile Menu Toggle Button (only visible when menu is closed) -->
  <button 
    *ngIf="!isMobileMenuOpen"
    (click)="toggleMobileMenu()"
    class="lg:hidden fixed top-4 left-4 z-50 bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-xl shadow-lg transition-all duration-200">
    <i class="fas fa-bars"></i>
  </button>

  <!-- Sidebar Stepper -->
  <aside 
    class="w-full lg:w-[280px] xl:w-[320px] bg-slate-800/85 backdrop-blur-md border border-purple-500/30 lg:rounded-2xl shadow-[0_8px_32px_rgba(0,0,0,0.3)] transition-transform duration-300 ease-in-out
           fixed lg:relative inset-0 lg:inset-auto z-40 lg:z-auto
           transform lg:transform-none"
    [class.-translate-x-full]="!isMobileMenuOpen"
    [class.translate-x-0]="isMobileMenuOpen">
    <div class="p-4 sm:p-6 h-full overflow-y-auto">
      <!-- Close button for mobile (inside sidebar) -->
      <button 
        (click)="toggleMobileMenu()"
        class="lg:hidden absolute top-4 right-4 text-white hover:text-purple-300 transition-colors">
        <i class="fas fa-times text-2xl"></i>
      </button>
      
      <h2 class="text-lg sm:text-xl font-bold text-white mb-4 sm:mb-5 font-['Inter','Segoe_UI',Tahoma,Geneva,Verdana,sans-serif] pt-0">Study Steps</h2>
      <nav>
        <ul class="flex flex-col gap-2 p-0 m-0 list-none">
          <li *ngFor="let step of steps; let i = index">
            <button (click)="setStep(i)"
              [ngClass]="{
                'bg-gradient-to-br from-purple-500 to-purple-700 text-white': currentStepIndex === i,
                'bg-slate-900/60 text-slate-200': currentStepIndex !== i
              }"
              class="w-full px-3 sm:px-4 py-2 sm:py-3 rounded-xl border-2 border-purple-500 text-xs sm:text-sm font-semibold cursor-pointer transition-all duration-200 text-left font-['Inter','Segoe_UI',Tahoma,Geneva,Verdana,sans-serif]">
              {{ step.title }}
            </button>
          </li>
        </ul>
      </nav>
    </div>
  </aside>

  <!-- Mobile Menu Backdrop -->
  <div 
    *ngIf="isMobileMenuOpen"
    (click)="toggleMobileMenu()"
    class="lg:hidden fixed inset-0 bg-black/50 z-30 backdrop-blur-sm"></div>

  <!-- Content Area -->
  <main class="w-full h-full overflow-hidden pt-16 lg:pt-0">
    <ng-container *ngIf="steps.length">
      <app-bible-reading *ngIf="readingData" [readingData]="readingData" [verseReference]="verseReference" class="w-full h-full"></app-bible-reading>
      <app-map-view *ngIf="mapData" [mapData]="mapData" class="w-full h-full"></app-map-view>
      <app-cluster-view *ngIf="clusterData" [clusterData]="clusterData" class="w-full h-full"></app-cluster-view>
      <!-- Add other step types here -->
    </ng-container>
    <ng-container *ngIf="!steps.length">
      <p class="text-slate-200 p-4 sm:p-8">Loading study steps...</p>
    </ng-container>
  </main>
</div>
